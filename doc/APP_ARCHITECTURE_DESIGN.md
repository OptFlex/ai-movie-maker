# AI Movie Maker - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆæ›¸

## æ¦‚è¦

AI Movie Makerã¯ã€å‹•ç”»åˆ¶ä½œã®ãŸã‚ã®çµ±åˆãƒ„ãƒ¼ãƒ«ç¾¤ã§ã™ã€‚ä»¥ä¸‹ã®3ã¤ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **çµµã‚³ãƒ³ãƒ†ä½œæˆã‚¢ãƒ—ãƒª**ï¼ˆstoryboard.htmlï¼‰- Supabaseé€£æºã€ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
2. **ç”»åƒç”Ÿæˆãƒ„ãƒ¼ãƒ«**ï¼ˆapi-test-image.htmlï¼‰- å˜ä½“ãƒ„ãƒ¼ãƒ«ã€ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆ
3. **å‹•ç”»ç”Ÿæˆãƒ„ãƒ¼ãƒ«**ï¼ˆapi-test-movie.htmlï¼‰- å˜ä½“ãƒ„ãƒ¼ãƒ«ã€ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆ

---

## ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆ

### 1. å…¨ä½“æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          https://ai-movie-maker.com      â”‚
â”‚              ï¼ˆRender ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”
    â”‚çµµã‚³ãƒ³ãƒ†â”‚  â”‚ç”»åƒç”Ÿæˆâ”‚  â”‚å‹•ç”»ç”Ÿæˆâ”‚
    â”‚ä½œæˆ   â”‚  â”‚ãƒ„ãƒ¼ãƒ«  â”‚  â”‚ãƒ„ãƒ¼ãƒ«  â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚Supabaseâ”‚
    â”‚Databaseâ”‚
    â”‚Storage â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
ai-movie-maker/
â”œâ”€â”€ index.html                     # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆãƒ„ãƒ¼ãƒ«é¸æŠï¼‰
â”œâ”€â”€ login.html                     # èªè¨¼ãƒšãƒ¼ã‚¸
â”œâ”€â”€ projects.html                  # ä¼ç”»ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆNEWï¼‰
â”œâ”€â”€ storyboard.html                # çµµã‚³ãƒ³ãƒ†ä½œæˆã‚¢ãƒ—ãƒª
â”œâ”€â”€ api-test-image.html            # ç”»åƒç”Ÿæˆãƒ„ãƒ¼ãƒ«
â”œâ”€â”€ api-test-movie.html            # å‹•ç”»ç”Ÿæˆãƒ„ãƒ¼ãƒ«
â”œâ”€â”€ server.js                      # Node.jsã‚µãƒ¼ãƒãƒ¼ï¼ˆãƒ—ãƒ­ã‚­ã‚· + é™çš„é…ä¿¡ï¼‰
â”œâ”€â”€ package.json                   # ä¾å­˜é–¢ä¿‚
â”œâ”€â”€ .env                           # ç’°å¢ƒå¤‰æ•°
â””â”€â”€ doc/                           # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â”œâ”€â”€ APP_ARCHITECTURE_DESIGN.md
    â”œâ”€â”€ SUPABASE_DATABASE_DESIGN.md
    â”œâ”€â”€ VEO3_API_REFERENCE.md
    â””â”€â”€ API_INTEGRATION_BEST_PRACTICES.md
```

---

## èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ–¹å¼ï¼‰

### æ¦‚è¦

- **èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**: Google OAuthï¼ˆSupabase Authã‚’ä½¿ç”¨ï¼‰
- **å®Ÿè£…æ–¹æ³•**: Supabase JavaScript SDKï¼ˆCDNçµŒç”±ï¼‰
- **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆï¼ˆallowed_emailsãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- **é©ç”¨ç¯„å›²**: å…¨ã‚¢ãƒ—ãƒªï¼ˆindex.htmlå«ã‚€ï¼‰

**é‡è¦:** Google OAuthã®èªè¨¼ãƒ•ãƒ­ãƒ¼ã¯å…¨ã¦SupabaseãŒå‡¦ç†ã—ã¾ã™ã€‚Googleèªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç›´æ¥ä½¿ã†å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

#### allowed_emails ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE allowed_emails (
  email TEXT PRIMARY KEY,
  name TEXT,
  added_at TIMESTAMPTZ DEFAULT NOW()
);

-- åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆç®¡ç†è€…ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰
INSERT INTO allowed_emails (email, name) VALUES
  ('your-email@gmail.com', 'ã‚ãªãŸã®åå‰');
```

### èªè¨¼ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹
   â†“
2. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆæœªãƒ­ã‚°ã‚¤ãƒ³ï¼Ÿï¼‰
   YES â†’ login.html ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   NO â†’ æ¬¡ã¸
   â†“
3. allowed_emails ãƒ†ãƒ¼ãƒ–ãƒ«ã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒã‚§ãƒƒã‚¯
   â†“
4. ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã«å­˜åœ¨ã™ã‚‹ï¼Ÿ
   YES â†’ ã‚¢ãƒ—ãƒªè¡¨ç¤º
   NO â†’ ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ + login.html ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
```

### å®Ÿè£…ä¾‹

#### login.htmlï¼ˆèªè¨¼ç”»é¢ï¼‰

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ­ã‚°ã‚¤ãƒ³ - AI Movie Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full">
        <h1 class="text-2xl font-bold mb-6 text-center">AI Movie Maker</h1>
        <p class="text-gray-600 mb-6 text-center text-sm">
            è¨±å¯ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™
        </p>

        <button id="google-login" class="w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-50 flex items-center justify-center gap-3 transition">
            <svg class="w-5 h-5" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            <span class="font-medium">Googleã§ãƒ­ã‚°ã‚¤ãƒ³</span>
        </button>

        <p class="text-xs text-gray-500 mt-6 text-center">
            â€» è¨±å¯ã•ã‚Œã¦ã„ãªã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¾ã›ã‚“
        </p>
    </div>

    <script type="module">
        const supabase = supabase.createClient(
            'YOUR_SUPABASE_URL',
            'YOUR_SUPABASE_ANON_KEY'
        )

        // ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³
        document.getElementById('google-login').addEventListener('click', async () => {
            const { data, error } = await supabase.auth.signInWithOAuth({
                provider: 'google',
                options: {
                    redirectTo: `${window.location.origin}/`
                }
            })

            if (error) {
                alert('ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message)
            }
        })
    </script>
</body>
</html>
```

#### å„HTMLå…±é€šã®èªè¨¼ãƒã‚§ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰

```javascript
// storyboard.html, api-test-image.html, api-test-movie.html, index.html ã®å†’é ­ã«è¿½åŠ 

const supabase = supabase.createClient(
    'YOUR_SUPABASE_URL',
    'YOUR_SUPABASE_ANON_KEY'
)

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«èªè¨¼ãƒã‚§ãƒƒã‚¯
window.addEventListener('DOMContentLoaded', async () => {
    // 1. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
    const { data: { session } } = await supabase.auth.getSession()

    if (!session) {
        // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„ â†’ ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸
        window.location.href = '/login.html'
        return
    }

    // 2. ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆãƒã‚§ãƒƒã‚¯
    const userEmail = session.user.email
    const { data: allowed, error } = await supabase
        .from('allowed_emails')
        .select('email')
        .eq('email', userEmail)
        .single()

    if (error || !allowed) {
        // ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã«ãªã„ â†’ ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦
        alert('ã“ã®ã‚¢ãƒ—ãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“')
        await supabase.auth.signOut()
        window.location.href = '/login.html'
        return
    }

    // 3. OK â†’ ã‚¢ãƒ—ãƒªã‚’è¡¨ç¤º
    document.getElementById('app').style.display = 'block'
})
```

---

## ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è©³ç´°

### 1. ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆindex.htmlï¼‰

#### å½¹å‰²
- 3ã¤ã®ãƒ„ãƒ¼ãƒ«ã¸ã®å…¥ã‚Šå£
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤º
- ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½

#### UIæ§‹æˆ

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Movie Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- èªè¨¼ãƒã‚§ãƒƒã‚¯ä¸­ã¯éè¡¨ç¤º -->
    <div id="app" style="display: none;">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-900">AI Movie Maker</h1>
                <div class="flex items-center gap-4">
                    <span id="user-email" class="text-sm text-gray-600"></span>
                    <button id="logout-btn" class="text-sm text-red-600 hover:text-red-700">
                        ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
                    </button>
                </div>
            </div>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <main class="max-w-7xl mx-auto px-4 py-12">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- çµµã‚³ãƒ³ãƒ†ä½œæˆã‚¢ãƒ—ãƒª -->
                <a href="./projects.html" class="block bg-white p-8 rounded-xl shadow-md hover:shadow-xl transition group">
                    <div class="text-5xl mb-4">ğŸ“‹</div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-3 group-hover:text-blue-600 transition">
                        çµµã‚³ãƒ³ãƒ†ä½œæˆ
                    </h2>
                    <p class="text-gray-600 mb-4">
                        å‹•ç”»åˆ¶ä½œã®ãŸã‚ã®çµµã‚³ãƒ³ãƒ†ã‚’ä½œæˆãƒ»ç®¡ç†ã§ãã¾ã™
                    </p>
                    <ul class="text-sm text-gray-500 space-y-1">
                        <li>âœ“ ä¼ç”»ãƒ»ã‚·ãƒ¼ãƒ³ãƒ»ã‚»ãƒªãƒ•ç®¡ç†</li>
                        <li>âœ“ åŸç¨¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆYAML/AIè§£æï¼‰</li>
                        <li>âœ“ ç”»åƒç”Ÿæˆãƒ»æ¡ç”¨æ©Ÿèƒ½</li>
                        <li>âœ“ ãƒ‡ãƒ¼ã‚¿è‡ªå‹•ä¿å­˜</li>
                    </ul>
                </a>

                <!-- ç”»åƒç”Ÿæˆãƒ„ãƒ¼ãƒ« -->
                <a href="/api-test-image.html" class="block bg-white p-8 rounded-xl shadow-md hover:shadow-xl transition group">
                    <div class="text-5xl mb-4">ğŸ–¼ï¸</div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-3 group-hover:text-purple-600 transition">
                        ç”»åƒç”Ÿæˆ
                    </h2>
                    <p class="text-gray-600 mb-4">
                        AIç”»åƒç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆGoogle Imagenï¼‰
                    </p>
                    <ul class="text-sm text-gray-500 space-y-1">
                        <li>âœ“ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ç”»åƒç”Ÿæˆ</li>
                        <li>âœ“ ç”Ÿæˆå±¥æ­´è¡¨ç¤º</li>
                        <li>âœ“ ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
                        <li>âœ“ ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãªã—ï¼ˆå˜ä½“åˆ©ç”¨ï¼‰</li>
                    </ul>
                </a>

                <!-- å‹•ç”»ç”Ÿæˆãƒ„ãƒ¼ãƒ« -->
                <a href="/api-test-movie.html" class="block bg-white p-8 rounded-xl shadow-md hover:shadow-xl transition group">
                    <div class="text-5xl mb-4">ğŸ¬</div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-3 group-hover:text-cyan-600 transition">
                        å‹•ç”»ç”Ÿæˆ
                    </h2>
                    <p class="text-gray-600 mb-4">
                        AIå‹•ç”»ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆGoogle Veo 3.1ï¼‰
                    </p>
                    <ul class="text-sm text-gray-500 space-y-1">
                        <li>âœ“ ç”»åƒ+ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰å‹•ç”»ç”Ÿæˆ</li>
                        <li>âœ“ ãƒ¢ãƒ‡ãƒ«é¸æŠï¼ˆFast/Standardï¼‰</li>
                        <li>âœ“ å‹•ç”»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
                        <li>âœ“ ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãªã—ï¼ˆå˜ä½“åˆ©ç”¨ï¼‰</li>
                    </ul>
                </a>
            </div>
        </main>
    </div>

    <script type="module">
        // èªè¨¼ãƒã‚§ãƒƒã‚¯ + ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤º + ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
        // ï¼ˆä¸Šè¨˜ã®å…±é€šèªè¨¼ãƒã‚§ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰ + è¿½åŠ æ©Ÿèƒ½ï¼‰

        const supabase = supabase.createClient(/* ... */)

        window.addEventListener('DOMContentLoaded', async () => {
            const { data: { session } } = await supabase.auth.getSession()

            if (!session) {
                window.location.href = '/login.html'
                return
            }

            // ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆãƒã‚§ãƒƒã‚¯
            // ...

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤º
            document.getElementById('user-email').textContent = session.user.email

            // ã‚¢ãƒ—ãƒªè¡¨ç¤º
            document.getElementById('app').style.display = 'block'
        })

        // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
        document.getElementById('logout-btn').addEventListener('click', async () => {
            await supabase.auth.signOut()
            window.location.href = '/login.html'
        })
    </script>
</body>
</html>
```

---

### 2. ä¼ç”»ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆprojects.htmlï¼‰

#### å½¹å‰²
- çµµã‚³ãƒ³ãƒ†ä¼ç”»ã®ä¸€è¦§è¡¨ç¤º
- ä¼ç”»ã®ä½œæˆãƒ»é¸æŠ
- Supabaseã¨é€£æºã—ã¦ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

#### ä¸»è¦æ©Ÿèƒ½

1. **ä¼ç”»ä¸€è¦§è¡¨ç¤º**
   - YouTubeé¢¨ã‚«ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
   - ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒï¼ˆã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ + çµµæ–‡å­—ï¼‰
   - ä¼ç”»ã‚¿ã‚¤ãƒˆãƒ«
   - æœ€çµ‚æ›´æ–°æ—¥

2. **ä¼ç”»ä½œæˆ**
   - æ–°è¦ä¼ç”»ä½œæˆãƒœã‚¿ãƒ³
   - storyboard.htmlã¸é·ç§»ï¼ˆæ–°è¦ãƒ¢ãƒ¼ãƒ‰ï¼‰

3. **ä¼ç”»é¸æŠ**
   - ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯ã§è©²å½“ä¼ç”»ã‚’é–‹ã
   - URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã‚’æ¸¡ã™ï¼ˆ`?project=1`ï¼‰

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã‚’å‰æã¨ã—ãŸãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿè£…

**é‡è¦:** ãƒ‡ãƒ¼ã‚¿ã¨UIã‚’åˆ†é›¢ã—ã€å¾Œã§Supabaseã«ç°¡å˜ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹è¨­è¨ˆ

**ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ï¼ˆSupabaseã®projectsãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã¨åŒã˜ï¼‰:**

```javascript
const mockProjects = [
    {
        id: 1,
        title: "YouTubeå‹•ç”»ä¼ç”» #1",
        channel_name: "Techè§£èª¬ãƒãƒ£ãƒ³ãƒãƒ«",
        thumbnail_url: null,  // å¾Œã§ç”»åƒURLãŒå…¥ã‚‹ï¼ˆSupabase Storageï¼‰
        thumbnail_emoji: "ğŸ“‹",  // ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ï¼ˆæœ¬ç•ªã§ã¯ä¸è¦ï¼‰
        thumbnail_gradient: "from-blue-400 to-purple-500",  // ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ï¼ˆæœ¬ç•ªã§ã¯ä¸è¦ï¼‰
        created_at: "2026-01-03T10:00:00",
        updated_at: "2026-01-03T15:30:00",
        user_id: "user123"
    },
    {
        id: 2,
        title: "è£½å“ç´¹ä»‹å‹•ç”»ä¼ç”»",
        channel_name: "ãƒ“ã‚¸ãƒã‚¹ãƒãƒ£ãƒ³ãƒãƒ«",
        thumbnail_url: null,
        thumbnail_emoji: "ğŸ¬",
        thumbnail_gradient: "from-green-400 to-blue-500",
        created_at: "2026-01-02T09:00:00",
        updated_at: "2026-01-02T14:20:00",
        user_id: "user123"
    },
    {
        id: 3,
        title: "ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«å‹•ç”»",
        channel_name: "Techè§£èª¬ãƒãƒ£ãƒ³ãƒãƒ«",
        thumbnail_url: null,
        thumbnail_emoji: "ğŸ“º",
        thumbnail_gradient: "from-orange-400 to-pink-500",
        created_at: "2026-01-01T11:00:00",
        updated_at: "2026-01-01T16:45:00",
        user_id: "user123"
    },
    {
        id: 4,
        title: "å•†å“ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ç”»",
        channel_name: "ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒãƒ£ãƒ³ãƒãƒ«",
        thumbnail_url: null,
        thumbnail_emoji: "ğŸ¥",
        thumbnail_gradient: "from-purple-400 to-indigo-500",
        created_at: "2025-12-31T13:00:00",
        updated_at: "2025-12-31T18:15:00",
        user_id: "user123"
    }
];
```

**NOTE:** `thumbnail_emoji`ã¨`thumbnail_gradient`ã¯ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ã®ä¸€æ™‚çš„ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã™ã€‚Supabaseæ¥ç¶šå¾Œã¯`thumbnail_url`ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

**ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°ï¼ˆå¾Œã§Supabaseã«ç½®ãæ›ãˆï¼‰:**

```javascript
async function loadProjects() {
    // TODO: Supabaseæ¥ç¶šæ™‚ã¯ä»¥ä¸‹ã«ç½®ãæ›ãˆ
    // const { data, error } = await supabase
    //     .from('projects')
    //     .select('*')
    //     .order('updated_at', { ascending: false });
    // if (error) throw error;
    // return data;

    // ç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™
    return mockProjects;
}
```

**å‹•çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°:**

```javascript
function renderProjects(projects) {
    const listDiv = document.getElementById('projects-list');

    const html = projects.map(project => `
        <div class="cursor-pointer group bg-white border-2 border-gray-200 rounded-xl p-3 shadow-md hover:shadow-xl hover:border-blue-400 transition-all"
             onclick="openProject(${project.id})">
            <div class="aspect-video bg-gradient-to-br ${project.thumbnail_gradient} rounded-lg mb-3 flex items-center justify-center text-white text-4xl">
                ${project.thumbnail_emoji}
            </div>
            <div>
                <h3 class="font-semibold text-gray-900 group-hover:text-blue-600 transition line-clamp-2 text-sm mb-2">
                    ${project.title}
                </h3>
                <p class="text-xs text-gray-500">${formatDate(project.updated_at)} æ›´æ–°</p>
            </div>
        </div>
    `).join('');

    listDiv.innerHTML = html;
}
```

**ä¼ç”»é¸æŠæ™‚ã®å‡¦ç†:**

```javascript
function openProject(projectId) {
    window.location.href = `./storyboard.html?project=${projectId}`;
}
```

#### Supabaseæ¥ç¶šæ™‚ã®å¤‰æ›´ç®‡æ‰€

å¾Œã§Supabaseã«æ¥ç¶šã™ã‚‹éš›ã¯ã€**loadProjectsé–¢æ•°ã®ã¿å¤‰æ›´ã™ã‚Œã°OK:**

```javascript
async function loadProjects() {
    const { data, error } = await supabase
        .from('projects')
        .select('*')
        .order('updated_at', { ascending: false });
    if (error) throw error;
    return data;
}
```

---

### 3. çµµã‚³ãƒ³ãƒ†ä½œæˆã‚¢ãƒ—ãƒªï¼ˆstoryboard.htmlï¼‰

#### å½¹å‰²
- é¸æŠã•ã‚ŒãŸä¼ç”»ã®çµµã‚³ãƒ³ãƒ†ç·¨é›†
- Supabaseã¨é€£æºã—ã¦ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- åŸç¨¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆYAML + AIè§£æï¼‰

#### URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- `?project=1` - ç·¨é›†ã™ã‚‹ä¼ç”»ã®ID
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã— - æ–°è¦ä¼ç”»ä½œæˆãƒ¢ãƒ¼ãƒ‰

#### ä¸»è¦æ©Ÿèƒ½

1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ç®¡ç†**
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåç·¨é›†ï¼ˆGPSã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸Šéƒ¨ï¼‰
   - URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã‚’å–å¾—
   - ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è©²å½“ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿è¾¼ã¿
   - GPSãƒ¡ãƒ¢ï¼ˆGoal/Plan/Statusï¼‰ç·¨é›†

2. **ã‚·ãƒ¼ãƒ³ç®¡ç†**
   - ã‚·ãƒ¼ãƒ³è¿½åŠ ãƒ»å‰Šé™¤
   - ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã³æ›¿ãˆ
   - ã‚·ãƒ¼ãƒ³ç•ªå·è‡ªå‹•æ›´æ–°

3. **ã‚»ãƒªãƒ•ç®¡ç†**
   - ã‚»ãƒªãƒ•è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤
   - è©±è€…ã¨ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›

4. **ç”»åƒç®¡ç†**
   - ç”»åƒç”Ÿæˆï¼ˆ**Gemini 3 Pro Image Preview API** - api-test-image.htmlã¨åŒã˜å®Ÿè£…ï¼‰
   - ç”Ÿæˆå±¥æ­´è¡¨ç¤º
   - ç”»åƒæ¡ç”¨ãƒ»å‰Šé™¤
   - Supabase Storageã«ä¿å­˜

5. **åŸç¨¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**ï¼ˆæ–°æ©Ÿèƒ½ï¼‰
   - **æ‰‹å‹•å…¥åŠ› â†’ AIè§£æï¼ˆGemini 3 Proï¼‰ â†’ YAMLç”Ÿæˆ â†’ ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**
   - **YAMLç›´æ¥ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã‚’å‰æã¨ã—ãŸãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿè£…

**URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã‚’å–å¾—:**

```javascript
const urlParams = new URLSearchParams(window.location.search);
const projectId = urlParams.get('project'); // "1" ãªã©
let currentProject = null;
```

**ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ï¼ˆprojects.htmlã¨åŒã˜ï¼‰:**

```javascript
const mockProjects = [
    {
        id: 1,
        title: "YouTubeå‹•ç”»ä¼ç”» #1",
        channel_name: "Techè§£èª¬ãƒãƒ£ãƒ³ãƒãƒ«",
        thumbnail_url: null,
        created_at: "2026-01-03T10:00:00",
        updated_at: "2026-01-03T15:30:00",
        user_id: "user123"
    },
    {
        id: 2,
        title: "è£½å“ç´¹ä»‹å‹•ç”»ä¼ç”»",
        channel_name: "ãƒ“ã‚¸ãƒã‚¹ãƒãƒ£ãƒ³ãƒãƒ«",
        thumbnail_url: null,
        created_at: "2026-01-02T09:00:00",
        updated_at: "2026-01-02T14:20:00",
        user_id: "user123"
    },
    // ...
];
```

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆå¾Œã§Supabaseã«ç½®ãæ›ãˆï¼‰:**

```javascript
async function loadProject(id) {
    // TODO: Supabaseæ¥ç¶šæ™‚ã¯ä»¥ä¸‹ã«ç½®ãæ›ãˆ
    // const { data, error } = await supabase
    //     .from('projects')
    //     .select('*')
    //     .eq('id', id)
    //     .single();
    // if (error) throw error;
    // return data;

    // ç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ¤œç´¢
    if (!id) {
        // æ–°è¦ä½œæˆãƒ¢ãƒ¼ãƒ‰
        return {
            id: null,
            title: "æ–°è¦ä¼ç”»",
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };
    }
    return mockProjects.find(p => p.id == id) || null;
}
```

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ã‚’ç”»é¢ã«åæ˜ :**

```javascript
window.addEventListener('DOMContentLoaded', async function() {
    currentProject = await loadProject(projectId);
    if (currentProject) {
        document.getElementById('project-title').value = currentProject.title;
    }

    // ã‚·ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ãªã©...
});
```

**UIè¨­è¨ˆå¤‰æ›´ç‚¹:**

- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¹ãƒªãƒ åŒ–ï¼ˆ`py-4` â†’ `py-3`ï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰å‰Šé™¤
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’GPSã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸Šéƒ¨ã«ç§»å‹•ã—ã€ç·¨é›†å¯èƒ½ãª`<input>`è¦ç´ ã¨ã—ã¦å®Ÿè£…
- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º: `text-base font-bold`
- **ã‚µãƒ ãƒã‚¤ãƒ«å°‚ç”¨ã‚¨ãƒªã‚¢ã‚’è¿½åŠ **ï¼ˆGPSã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸‹ã€ã‚·ãƒ¼ãƒ³ä¸€è¦§ã®ä¸Šï¼‰
  - ä¼ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒè¡¨ç¤º/ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  - ä¼ç”»ã‚¿ã‚¤ãƒˆãƒ«è¡¨ç¤º
  - ãƒãƒ£ãƒ³ãƒãƒ«åè¡¨ç¤º
  - ã‚·ãƒ¼ãƒ³ã¨ã¯åˆ¥è»¸ã§ç®¡ç†ï¼ˆ`projects.thumbnail_url`ï¼‰

#### Supabaseæ¥ç¶šæ™‚ã®å¤‰æ›´ç®‡æ‰€

å¾Œã§Supabaseã«æ¥ç¶šã™ã‚‹éš›ã¯ã€**loadProjecté–¢æ•°ã®ã¿å¤‰æ›´ã™ã‚Œã°OK:**

```javascript
async function loadProject(id) {
    const { data, error } = await supabase
        .from('projects')
        .select('*')
        .eq('id', id)
        .single();
    if (error) throw error;
    return data;
}
```

#### åŸç¨¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½è©³ç´°

##### YAMLãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®šç¾©

```yaml
# çµµã‚³ãƒ³ãƒ†åŸç¨¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

title: YouTubeå‹•ç”»ä¼ç”» #1

gps:
  goal: è¦–è´è€…ã«è£½å“ã®é­…åŠ›ã‚’ä¼ãˆã‚‹
  plan: 3åˆ†ã®è§£èª¬å‹•ç”»ã€5ã‚·ãƒ¼ãƒ³æ§‹æˆ
  status: å°æœ¬ä½œæˆå®Œäº†

scenes:
  - number: 1
    dialogues:
      - speaker: ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼
        text: ã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã¯AIå‹•ç”»åˆ¶ä½œãƒ„ãƒ¼ãƒ«ã‚’ç´¹ä»‹ã—ã¾ã™
      - speaker: ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼
        text: ã“ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã°èª°ã§ã‚‚ç°¡å˜ã«å‹•ç”»ãŒä½œã‚Œã¾ã™

  - number: 2
    dialogues:
      - speaker: çœŸå­ã•ã‚“
        text: è¦‹ãŸç›®ã ã‘ã‚’åˆ†ã‘ãªã‹ã‚ã†ã‚‚ã‚“ã§
      - speaker: å¤ªéƒã•ã‚“
        text: ãã†ã§ã™ã­ã€ä¸­èº«ã‚‚å¤§äº‹ã§ã™

  - number: 3
    dialogues:
      - speaker: ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼
        text: æ¬¡ã®ã‚·ãƒ¼ãƒ³ã§ã¯å…·ä½“çš„ãªä½¿ã„æ–¹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†
```

##### AIè§£ææ©Ÿèƒ½

**ä½¿ç”¨API:**
- **API**: Google Gemini API
- **ãƒ¢ãƒ‡ãƒ«**: `gemini-3-pro-preview`ï¼ˆæ¨å¥¨ï¼‰ / `gemini-2.0-flash-exp` / `gemini-1.5-pro-latest`
- **æ¨å¥¨**: `gemini-3-pro-preview`ï¼ˆGoogleå²ä¸Šæœ€ã‚‚å¼·åŠ›ãªãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ç†è§£ãƒ¢ãƒ‡ãƒ«ï¼‰

**ãƒ•ãƒ­ãƒ¼:**

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªç”±å½¢å¼ã®åŸç¨¿ã‚’å…¥åŠ›
   â†“
2. Gemini APIã«æŠ•ã’ã¦æ§‹é€ åŒ–
   â†“
3. YAMLå½¢å¼ã§è¿”å´
   â†“
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¢ºèªãƒ»ç·¨é›†
   â†“
5. ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ
```

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:**

```javascript
const AI_CONVERSION_PROMPT = `
ã‚ãªãŸã¯å‹•ç”»åˆ¶ä½œã®çµµã‚³ãƒ³ãƒ†ä½œæˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚
ä»¥ä¸‹ã®åŸç¨¿ã‚’ã€çµµã‚³ãƒ³ãƒ†ç”¨ã«æ§‹é€ åŒ–ã—ã¦YAMLå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

# åŸç¨¿
${userScript}

# å‡ºåŠ›å½¢å¼
title: ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆåŸç¨¿ã‹ã‚‰æŠ½å‡ºã€ãªã‘ã‚Œã°"ç„¡é¡Œã®ä¼ç”»"ï¼‰
gps:
  goal: ç›®æ¨™ï¼ˆåŸç¨¿ã‹ã‚‰æŠ½å‡ºã€ãªã‘ã‚Œã°ç©ºæ–‡å­—ï¼‰
  plan: è¨ˆç”»ï¼ˆåŸç¨¿ã‹ã‚‰æŠ½å‡ºã€ãªã‘ã‚Œã°ç©ºæ–‡å­—ï¼‰
  status: é€²æ—çŠ¶æ³ï¼ˆåŸç¨¿ã‹ã‚‰æŠ½å‡ºã€ãªã‘ã‚Œã°ç©ºæ–‡å­—ï¼‰

scenes:
  - number: 1
    dialogues:
      - speaker: è©±è€…å
        text: ã‚»ãƒªãƒ•å†…å®¹
      - speaker: è©±è€…å
        text: ã‚»ãƒªãƒ•å†…å®¹
  - number: 2
    dialogues:
      - speaker: è©±è€…å
        text: ã‚»ãƒªãƒ•å†…å®¹

# ãƒ«ãƒ¼ãƒ«
1. ã‚·ãƒ¼ãƒ³ã¯è©±é¡Œã‚„å ´é¢ãŒå¤‰ã‚ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§åŒºåˆ‡ã‚‹
2. è©±è€…ãŒæ˜è¨˜ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€ŒãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ã€ã¨ã™ã‚‹
3. 1ã‚·ãƒ¼ãƒ³ã¯30ç§’ã€œ1åˆ†ç¨‹åº¦ã‚’ç›®å®‰ã«ï¼ˆã‚»ãƒªãƒ•2ã€œ5å€‹ç¨‹åº¦ï¼‰
4. ã‚·ãƒ¼ãƒ³ç•ªå·ã¯1ã‹ã‚‰é€£ç•ª
5. YAMLãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å³å¯†ã«å®ˆã‚‹
6. ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ä¸è¦ã€YAMLã®ã¿ã‚’å‡ºåŠ›

# å‡ºåŠ›ä¾‹
title: ã‚µãƒ³ãƒ—ãƒ«å‹•ç”»ä¼ç”»
gps:
  goal: å•†å“ã®é­…åŠ›ã‚’ä¼ãˆã‚‹
  plan: 3åˆ†å‹•ç”»ã€5ã‚·ãƒ¼ãƒ³
  status: æ§‹æˆæ¡ˆä½œæˆä¸­

scenes:
  - number: 1
    dialogues:
      - speaker: ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼
        text: å•†å“ç´¹ä»‹ã‚’å§‹ã‚ã¾ã™
`
```

**APIå‘¼ã³å‡ºã—:**

```javascript
// Gemini APIã§åŸç¨¿ã‚’YAMLã«å¤‰æ›
async function convertScriptWithAI(rawScript) {
    const apiKey = 'YOUR_GOOGLE_AI_API_KEY' // ç”»åƒãƒ»å‹•ç”»ç”Ÿæˆã¨åŒã˜APIã‚­ãƒ¼
    const modelName = 'gemini-3-pro-preview' // æ¨å¥¨: Gemini 3 Pro
    // ã¾ãŸã¯: 'gemini-2.0-flash-exp', 'gemini-1.5-pro-latest'
    const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`

    const prompt = AI_CONVERSION_PROMPT.replace('${userScript}', rawScript)

    const response = await fetch(endpoint, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            contents: [{
                parts: [{ text: prompt }]
            }]
        })
    })

    const data = await response.json()
    const yamlText = data.candidates[0].content.parts[0].text

    return yamlText
}
```

**ãƒ¡ãƒªãƒƒãƒˆ:**
- **APIã‚­ãƒ¼1ã¤ã§å…¨æ©Ÿèƒ½ãŒå‹•ã**ï¼ˆç”»åƒãƒ»å‹•ç”»ãƒ»åŸç¨¿è§£æï¼‰
- **ç„¡æ–™æ ãŒå¤§ãã„**ï¼ˆ1æ—¥150ä¸‡ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
- **æ—¢å­˜å®Ÿè£…ã¨åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³**ï¼ˆapi-test-image.htmlã¨åŒæ§˜ï¼‰
- **ã‚³ã‚¹ãƒˆå‰Šæ¸›**ï¼ˆClaude APIã‚ˆã‚Šåœ§å€’çš„ã«å®‰ã„ï¼‰

##### ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«UI

```html
<!-- åŸç¨¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³ï¼ˆGPSãƒ¡ãƒ¢ä¸Šéƒ¨ã«é…ç½®ï¼‰ -->
<div class="mb-4">
    <button id="import-script-btn" class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
        </svg>
        åŸç¨¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    </button>
</div>

<!-- ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="import-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="p-6 border-b border-gray-200 flex items-center justify-between">
            <h2 class="text-2xl font-bold text-gray-900">åŸç¨¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h2>
            <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
        <div class="flex border-b border-gray-200">
            <button class="tab-btn px-6 py-3 font-medium border-b-2 border-blue-600 text-blue-600" data-tab="ai">
                âœ¨ AIè§£æ
            </button>
            <button class="tab-btn px-6 py-3 font-medium text-gray-600 hover:text-gray-900" data-tab="yaml">
                ğŸ“„ YAMLç›´æ¥
            </button>
        </div>

        <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
        <div class="flex-1 overflow-y-auto p-6">
            <!-- AIè§£æã‚¿ãƒ– -->
            <div id="tab-ai" class="tab-content">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        åŸç¨¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆè‡ªç”±å½¢å¼ï¼‰
                    </label>
                    <textarea id="raw-script-input" rows="15" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ä¾‹:

ã‚¿ã‚¤ãƒˆãƒ«: YouTubeå‹•ç”»ä¼ç”» #1
ç›®æ¨™: è¦–è´è€…ã«è£½å“ã®é­…åŠ›ã‚’ä¼ãˆã‚‹

ã€ã‚·ãƒ¼ãƒ³1ã€‘
ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ã€Œã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã¯AIå‹•ç”»åˆ¶ä½œãƒ„ãƒ¼ãƒ«ã‚’ç´¹ä»‹ã—ã¾ã™ã€
ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ã€Œã“ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã°èª°ã§ã‚‚ç°¡å˜ã«å‹•ç”»ãŒä½œã‚Œã¾ã™ã€

ã€ã‚·ãƒ¼ãƒ³2ã€‘
çœŸå­ã•ã‚“ã€Œè¦‹ãŸç›®ã ã‘ã‚’åˆ†ã‘ãªã‹ã‚ã†ã‚‚ã‚“ã§ã€
å¤ªéƒã•ã‚“ã€Œãã†ã§ã™ã­ã€ä¸­èº«ã‚‚å¤§äº‹ã§ã™ã€
"></textarea>
                </div>

                <button id="ai-convert-btn" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition font-medium flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    AIã§æ§‹é€ åŒ–
                </button>

                <!-- AIå¤‰æ›çµæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
                <div id="ai-result" class="hidden mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        å¤‰æ›çµæœï¼ˆç·¨é›†å¯èƒ½ï¼‰
                    </label>
                    <textarea id="ai-yaml-output" rows="15" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>

                    <button id="import-ai-yaml-btn" class="mt-4 w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition font-medium">
                        ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ
                    </button>
                </div>
            </div>

            <!-- YAMLç›´æ¥ã‚¿ãƒ– -->
            <div id="tab-yaml" class="tab-content hidden">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        YAMLå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„
                    </label>
                    <textarea id="yaml-direct-input" rows="20" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="title: YouTubeå‹•ç”»ä¼ç”» #1

gps:
  goal: è¦–è´è€…ã«è£½å“ã®é­…åŠ›ã‚’ä¼ãˆã‚‹
  plan: 3åˆ†ã®è§£èª¬å‹•ç”»ã€5ã‚·ãƒ¼ãƒ³æ§‹æˆ
  status: å°æœ¬ä½œæˆå®Œäº†

scenes:
  - number: 1
    dialogues:
      - speaker: ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼
        text: ã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã¯AIå‹•ç”»åˆ¶ä½œãƒ„ãƒ¼ãƒ«ã‚’ç´¹ä»‹ã—ã¾ã™
"></textarea>
                </div>

                <button id="import-yaml-btn" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition font-medium">
                    ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ
                </button>
            </div>
        </div>
    </div>
</div>
```

##### ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†

```javascript
// js-yaml ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ï¼ˆCDNã§èª­ã¿è¾¼ã¿ï¼‰
// <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>

// YAMLã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†
async function importFromYAML(yamlText) {
    try {
        // YAMLãƒ‘ãƒ¼ã‚¹
        const data = jsyaml.load(yamlText)

        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        if (!data.scenes || !Array.isArray(data.scenes)) {
            throw new Error('scenesé…åˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“')
        }

        // ä¼ç”»æƒ…å ±ã‚’Supabaseã«ä¿å­˜
        const { data: project, error: projectError } = await supabase
            .from('projects')
            .insert({
                title: data.title || 'ç„¡é¡Œã®ä¼ç”»',
                goal: data.gps?.goal || '',
                plan: data.gps?.plan || '',
                status: data.gps?.status || ''
            })
            .select()
            .single()

        if (projectError) throw projectError

        // ã‚·ãƒ¼ãƒ³ã¨ã‚»ãƒªãƒ•ã‚’ä¿å­˜
        for (const sceneData of data.scenes) {
            // ã‚·ãƒ¼ãƒ³ä½œæˆ
            const { data: scene, error: sceneError } = await supabase
                .from('scenes')
                .insert({
                    project_id: project.id,
                    number: sceneData.number
                })
                .select()
                .single()

            if (sceneError) throw sceneError

            // ã‚»ãƒªãƒ•ä½œæˆ
            if (sceneData.dialogues && Array.isArray(sceneData.dialogues)) {
                for (let i = 0; i < sceneData.dialogues.length; i++) {
                    const dialogue = sceneData.dialogues[i]

                    await supabase
                        .from('dialogues')
                        .insert({
                            scene_id: scene.id,
                            speaker: dialogue.speaker,
                            text: dialogue.text,
                            order_index: i
                        })
                }
            }
        }

        // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸï¼')

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã¦ã€ä½œæˆã—ãŸä¼ç”»ã‚’è¡¨ç¤º
        closeImportModal()
        loadProject(project.id)

    } catch (error) {
        alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ' + error.message)
        console.error(error)
    }
}

// AIå¤‰æ›å‡¦ç†
async function convertWithAI() {
    const rawScript = document.getElementById('raw-script-input').value.trim()

    if (!rawScript) {
        alert('åŸç¨¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„')
        return
    }

    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    const btn = document.getElementById('ai-convert-btn')
    btn.disabled = true
    btn.innerHTML = '<svg class="animate-spin w-5 h-5" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> å¤‰æ›ä¸­...'

    try {
        const yamlText = await convertScriptWithAI(rawScript)

        // çµæœã‚’è¡¨ç¤º
        document.getElementById('ai-yaml-output').value = yamlText
        document.getElementById('ai-result').classList.remove('hidden')

    } catch (error) {
        alert('AIå¤‰æ›ã‚¨ãƒ©ãƒ¼: ' + error.message)
        console.error(error)
    } finally {
        btn.disabled = false
        btn.innerHTML = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> AIã§æ§‹é€ åŒ–'
    }
}

// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
document.getElementById('ai-convert-btn').addEventListener('click', convertWithAI)
document.getElementById('import-ai-yaml-btn').addEventListener('click', () => {
    const yamlText = document.getElementById('ai-yaml-output').value
    importFromYAML(yamlText)
})
document.getElementById('import-yaml-btn').addEventListener('click', () => {
    const yamlText = document.getElementById('yaml-direct-input').value
    importFromYAML(yamlText)
})
```

---

### 4. ç”»åƒç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆapi-test-image.htmlï¼‰

#### å½¹å‰²
- AIç”»åƒç”Ÿæˆï¼ˆ**Gemini 3 Pro Image Preview** - Nano Banana Proï¼‰
- å˜ä½“ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦å‹•ä½œ
- ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãªã—ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³é™ã‚Šï¼‰

#### ä½¿ç”¨API
- **API**: Google Gemini API
- **ãƒ¢ãƒ‡ãƒ«**: `gemini-3-pro-image-preview` (Nano Banana Pro)
- **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-image-preview:generateContent`
- **èªè¨¼æ–¹æ³•**: APIã‚­ãƒ¼ï¼ˆã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ `?key=YOUR_API_KEY`ï¼‰
- **ãƒ—ãƒ­ã‚­ã‚·**: ä¸è¦ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç›´æ¥ãƒªã‚¯ã‚¨ã‚¹ãƒˆå¯èƒ½ï¼‰
- **ç‰¹å¾´**:
  - é«˜è§£åƒåº¦å‡ºåŠ›ï¼ˆ4Kå¯¾å¿œï¼‰
  - é«˜åº¦ãªãƒ†ã‚­ã‚¹ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
  - è¤‡æ•°ç”»åƒå‚ç…§å¯èƒ½ï¼ˆæœ€å¤§14æšï¼‰
  - ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«å‘ã‘ã‚¢ã‚»ãƒƒãƒˆä½œæˆã«æœ€é©

#### ä¸»è¦æ©Ÿèƒ½
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¥åŠ›
- ç”Ÿæˆæšæ•°é¸æŠï¼ˆ1/2/4/8æšï¼‰
- ç”»è³ªé¸æŠï¼ˆæ¨™æº–/HD/UHDï¼‰
- ç”»åƒç”Ÿæˆï¼ˆè¤‡æ•°æšåŒæ™‚ç”Ÿæˆï¼‰
- ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆå€‹åˆ¥ï¼‰

#### å®Ÿè£…ä¾‹

```javascript
// api-test-image.html ã®å®Ÿè£…æ–¹æ³•
async function generateImages() {
    const apiKey = document.getElementById('nanobanana-api-key').value
    const prompt = document.getElementById('nanobanana-prompt').value
    const count = parseInt(document.getElementById('nanobanana-count').value)

    const modelName = 'gemini-3-pro-image-preview' // Nano Banana Pro
    const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`

    // è¤‡æ•°ç”»åƒã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã€countå›ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    const promises = []
    for (let i = 0; i < count; i++) {
        promises.push(
            fetch(endpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: prompt }]
                    }],
                    generationConfig: {
                        responseModalities: ["Text", "Image"]
                    }
                })
            })
        )
    }

    const responses = await Promise.all(promises)

    // ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºï¼ˆBase64ï¼‰
    for (const response of responses) {
        const data = await response.json()
        const imageData = data.candidates[0].content.parts
            .find(p => p.inlineData).inlineData.data

        // ç”»åƒã‚’è¡¨ç¤ºãƒ»ä¿å­˜
        displayImage(imageData)
    }
}
```

#### Supabaseé€£æº
- **ãªã—**ï¼ˆèªè¨¼ã®ã¿ä½¿ç”¨ï¼‰

---

### 5. å‹•ç”»ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆapi-test-movie.htmlï¼‰

#### å½¹å‰²
- AIå‹•ç”»ç”Ÿæˆï¼ˆ**Google Veo 3.1 API**ï¼‰
- å˜ä½“ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦å‹•ä½œ
- ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãªã—ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³é™ã‚Šï¼‰

#### ä½¿ç”¨API
- **API**: Google Veo 3.1 API
- **ãƒ¢ãƒ‡ãƒ«**: `veo-3.1-fast-generate-preview` (æ¨å¥¨) / `veo-3.1-generate-preview`
- **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `https://generativelanguage.googleapis.com/v1beta/models/{modelName}:generateVideo`
- **èªè¨¼æ–¹æ³•**: APIã‚­ãƒ¼ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ `x-goog-api-key`ï¼‰
- **ãƒ—ãƒ­ã‚­ã‚·**: **å¿…é ˆ**ï¼ˆserver.jsçµŒç”± - CORSå›é¿ã®ãŸã‚ï¼‰

#### ä¸»è¦æ©Ÿèƒ½
- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¥åŠ›
- ãƒ¢ãƒ‡ãƒ«é¸æŠï¼ˆVeo 3.1 Fast / Standardï¼‰
- å‹•ç”»ã®é•·ã•ï¼ˆ8ç§’å›ºå®šï¼‰
- FPSé¸æŠï¼ˆ24fps / 30fpsï¼‰
- å‹•ç”»ç”Ÿæˆï¼ˆéåŒæœŸå‡¦ç†ï¼‰
- ç”ŸæˆçŠ¶æ³ãƒãƒ¼ãƒªãƒ³ã‚°ï¼ˆ5ç§’é–“éš”ï¼‰
- å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- å‹•ç”»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

#### å®Ÿè£…ä¾‹

```javascript
// api-test-movie.html ã®å®Ÿè£…æ–¹æ³•ï¼ˆãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼çµŒç”±ï¼‰
async function generateVideo() {
    const apiKey = document.getElementById('veo3-api-key').value
    const prompt = document.getElementById('veo3-prompt').value
    const imageBase64 = await fileToBase64(uploadedImageFile)
    const modelName = document.getElementById('veo3-model').value // 'veo-3.1-fast-generate-preview'

    // ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼ï¼ˆserver.jsï¼‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    const response = await fetch('http://localhost:3000/generate-video', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            apiKey: apiKey,
            prompt: prompt,
            imageBase64: imageBase64,
            duration: 8,
            fps: 24,
            modelName: modelName
        })
    })

    const data = await response.json()

    if (data.operationName) {
        // éåŒæœŸå‡¦ç†ã®å®Œäº†ã‚’å¾…ã¤ï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰
        await pollOperationStatus(data.operationName, apiKey)
    }
}

// ãƒãƒ¼ãƒªãƒ³ã‚°å‡¦ç†
async function pollOperationStatus(operationName, apiKey) {
    const response = await fetch('http://localhost:3000/check-operation', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            apiKey: apiKey,
            operationName: operationName
        })
    })

    const data = await response.json()

    if (data.done) {
        const videoUri = data.response.generateVideoResponse.generatedSamples[0].video.uri
        downloadVideoFromUri(videoUri)
    } else {
        // 5ç§’å¾Œã«å†è©¦è¡Œ
        setTimeout(() => pollOperationStatus(operationName, apiKey), 5000)
    }
}
```

#### æ–™é‡‘æƒ…å ±
- **Veo 3.1 Fast**: $0.15/ç§’ï¼ˆ8ç§’å‹•ç”» = $1.20ï¼‰- æ¨å¥¨
- **Veo 3.1 Standard**: $0.40/ç§’ï¼ˆ8ç§’å‹•ç”» = $3.20ï¼‰

#### Supabaseé€£æº
- **ãªã—**ï¼ˆèªè¨¼ã®ã¿ä½¿ç”¨ï¼‰

---

## ã‚µãƒ¼ãƒãƒ¼æ§‹æˆï¼ˆserver.jsï¼‰

### å½¹å‰²
1. **é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡** - å…¨HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ä¿¡
2. **Veo 3 APIãƒ—ãƒ­ã‚­ã‚·** - CORSå›é¿ã€APIã‚­ãƒ¼éš è”½

### å®Ÿè£…

```javascript
const http = require('http');
const https = require('https');
const fs = require('fs');
const path = require('path');

const PORT = process.env.PORT || 3000;
const VEO3_API_KEY = process.env.VEO3_API_KEY;

const server = http.createServer(async (req, res) => {
    // CORSè¨­å®š
    res.setHeader('Access-Control-Allow-Origin', '*');
    res.setHeader('Access-Control-Allow-Methods', 'POST, GET, OPTIONS');
    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');

    if (req.method === 'OPTIONS') {
        res.writeHead(200);
        res.end();
        return;
    }

    // === API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ===

    // å‹•ç”»ç”Ÿæˆ
    if (req.url === '/generate-video' && req.method === 'POST') {
        let body = '';
        req.on('data', chunk => { body += chunk; });
        req.on('end', async () => {
            const requestData = JSON.parse(body);

            // Veo3 APIå‘¼ã³å‡ºã—ï¼ˆæ—¢å­˜å®Ÿè£…ï¼‰
            // ...
        });
    }

    // æ“ä½œç¢ºèª
    else if (req.url === '/check-operation' && req.method === 'POST') {
        // æ—¢å­˜å®Ÿè£…
        // ...
    }

    // === é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ ===
    else {
        let filePath = '.' + req.url;
        if (filePath === './') {
            filePath = './index.html';
        }

        const extname = String(path.extname(filePath)).toLowerCase();
        const mimeTypes = {
            '.html': 'text/html',
            '.js': 'text/javascript',
            '.css': 'text/css',
            '.json': 'application/json',
            '.png': 'image/png',
            '.jpg': 'image/jpg',
            '.svg': 'image/svg+xml',
            '.ico': 'image/x-icon'
        };

        const contentType = mimeTypes[extname] || 'application/octet-stream';

        fs.readFile(filePath, (error, content) => {
            if (error) {
                if (error.code === 'ENOENT') {
                    res.writeHead(404, { 'Content-Type': 'text/html' });
                    res.end('<h1>404 Not Found</h1>', 'utf-8');
                } else {
                    res.writeHead(500);
                    res.end('Server Error: ' + error.code);
                }
            } else {
                res.writeHead(200, { 'Content-Type': contentType });
                res.end(content, 'utf-8');
            }
        });
    }
});

server.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
});
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤æ§‹æˆï¼ˆRenderï¼‰

### ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•

#### 1. Renderãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š

- **Type**: Web Service
- **Environment**: Node
- **Build Command**: `npm install`
- **Start Command**: `node server.js`

#### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

```
PORT=3000

# Google API Key (ç”»åƒç”Ÿæˆãƒ»å‹•ç”»ç”Ÿæˆãƒ»åŸç¨¿è§£æ å…¨ã¦ã§ä½¿ç”¨)
GOOGLE_AI_API_KEY=your-google-ai-studio-api-key

# Supabase (èªè¨¼ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸)
SUPABASE_URL=your-supabase-url
SUPABASE_ANON_KEY=your-supabase-anon-key
```

**é‡è¦:**
- `GOOGLE_AI_API_KEY` **1ã¤ã§å…¨æ©Ÿèƒ½ãŒå‹•ãã¾ã™**
  - ç”»åƒç”Ÿæˆï¼ˆ**Gemini 3 Pro Image Preview** - Nano Banana Proï¼‰
  - å‹•ç”»ç”Ÿæˆï¼ˆVeo 3.1ï¼‰
  - åŸç¨¿AIè§£æï¼ˆ**Gemini 3 Pro Preview**ï¼‰
- Google AI Studioã‹ã‚‰å–å¾—: https://aistudio.google.com/
- **Claude APIã¯ä¸è¦**ï¼ˆAPIã‚­ãƒ¼ã®ç®¡ç†ãŒç°¡ç´ åŒ–ï¼‰

#### 3. package.json

```json
{
  "name": "ai-movie-maker",
  "version": "1.0.0",
  "description": "AI Movie Maker - å‹•ç”»åˆ¶ä½œçµ±åˆãƒ„ãƒ¼ãƒ«",
  "main": "server.js",
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {}
}
```

### ã‚¢ã‚¯ã‚»ã‚¹URL

ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®å„ãƒšãƒ¼ã‚¸ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ï¼š

```
https://ai-movie-maker.onrender.com/                    # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆãƒ„ãƒ¼ãƒ«é¸æŠï¼‰
https://ai-movie-maker.onrender.com/login.html         # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
https://ai-movie-maker.onrender.com/projects.html      # ä¼ç”»ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆNEWï¼‰
https://ai-movie-maker.onrender.com/storyboard.html    # çµµã‚³ãƒ³ãƒ†ä½œæˆã‚¢ãƒ—ãƒª
https://ai-movie-maker.onrender.com/api-test-image.html # ç”»åƒç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆGeminiï¼‰
https://ai-movie-maker.onrender.com/api-test-movie.html # å‹•ç”»ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆVeo3ï¼‰
```

**ç”»é¢é·ç§»ãƒ•ãƒ­ãƒ¼:**
```
login.html â†’ index.html â†’ projects.html â†’ storyboard.html?project=1
                       â†“
                  api-test-image.html
                       â†“
                  api-test-movie.html
```

**èªè¨¼ãƒ•ãƒ­ãƒ¼:**
1. æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ â†’ `/login.html` ã¸è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
2. Googleèªè¨¼ â†’ ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆãƒã‚§ãƒƒã‚¯
3. èªè¨¼æˆåŠŸ â†’ `/` (ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸) ã¸
4. å„ãƒ„ãƒ¼ãƒ«ã¸ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### 1. èªè¨¼ãƒ»èªå¯

- **èªè¨¼**: Supabase Authï¼ˆGoogle OAuthï¼‰
- **èªå¯**: ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ–¹å¼ï¼ˆallowed_emailsãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: Supabaseï¼ˆè‡ªå‹•ï¼‰

### 2. APIã‚­ãƒ¼ç®¡ç†

- **ä¿å­˜å ´æ‰€**: ç’°å¢ƒå¤‰æ•°ï¼ˆRenderï¼‰
- **å…¬é–‹**: ãªã—ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ã¿ä½¿ç”¨ï¼‰
- **Veo3 API**: ãƒ—ãƒ­ã‚­ã‚·çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹
- **Claude API**: ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§å‘¼ã³å‡ºã—

### 3. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

- **Row Level Security (RLS)**: æœ‰åŠ¹
- **ãƒãƒªã‚·ãƒ¼**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- **Storage RLS**: æœ‰åŠ¹

---

## ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

### Supabaseï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: 500MB
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 1GB
- å¸¯åŸŸå¹…: 2GB/æœˆ
- æœˆé–“ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼: ç„¡åˆ¶é™

**å€‹äººåˆ©ç”¨ãªã‚‰ç„¡æ–™æ ã§ååˆ†**

### Renderï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰

- 750æ™‚é–“/æœˆï¼ˆ1ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
- 512MB RAM
- ã‚¹ãƒªãƒ¼ãƒ—ã‚ã‚Šï¼ˆ15åˆ†ã‚¢ã‚¯ã‚»ã‚¹ãªã—ã§ä¼‘æ­¢ï¼‰

**å€‹äººåˆ©ç”¨ãªã‚‰ç„¡æ–™æ ã§ååˆ†**

### å¤–éƒ¨API

#### ç”»åƒç”Ÿæˆ
- **Gemini 3 Pro Image Preview (Nano Banana Pro)**: ç„¡æ–™ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æœŸé–“ä¸­ï¼‰
- ãƒ¢ãƒ‡ãƒ«: `gemini-3-pro-image-preview`
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `generativelanguage.googleapis.com`
- ç‰¹å¾´: é«˜è§£åƒåº¦ï¼ˆ4Kï¼‰ã€é«˜åº¦ãªãƒ†ã‚­ã‚¹ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã€ãƒ—ãƒ­å‘ã‘

#### å‹•ç”»ç”Ÿæˆ
- **Google Veo 3.1 Fast**: $0.15/ç§’ï¼ˆ8ç§’å‹•ç”» = $1.20ï¼‰
- **Google Veo 3.1 Standard**: $0.40/ç§’ï¼ˆ8ç§’å‹•ç”» = $3.20ï¼‰
- ãƒ¢ãƒ‡ãƒ«: `veo-3.1-fast-generate-preview` / `veo-3.1-generate-preview`
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `generativelanguage.googleapis.com`

#### AIåŸç¨¿è§£æ
- **Google Gemini API**: ç„¡æ–™æ å¤§ï¼ˆ1æ—¥150ä¸‡ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
- ãƒ¢ãƒ‡ãƒ«: `gemini-3-pro-preview`ï¼ˆæ¨å¥¨ - Googleå²ä¸Šæœ€å¼·ï¼‰ / `gemini-2.0-flash-exp` / `gemini-1.5-pro-latest`
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `generativelanguage.googleapis.com`
- å…¥åŠ›: ãƒ†ã‚­ã‚¹ãƒˆã€ç”»åƒã€å‹•ç”»ã€éŸ³å£°ã€PDFå¯¾å¿œ
- å‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³ä¸Šé™: 65,536

**é‡è¦: å…¨æ©Ÿèƒ½ã§Google API Key 1ã¤ã®ã¿ä½¿ç”¨**

---

## å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### Phase 0: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå®Œäº† âœ…ï¼‰

- [x] login.html ä½œæˆï¼ˆGoogleãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼‰
- [x] index.html ä½œæˆï¼ˆãƒ„ãƒ¼ãƒ«é¸æŠãƒšãƒ¼ã‚¸ï¼‰
- [x] projects.html ä½œæˆï¼ˆä¼ç”»ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼‰
- [x] storyboard.html UIèª¿æ•´ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ã‚¹ãƒªãƒ åŒ–ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåç§»å‹•ï¼‰
- [x] ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å®Ÿè£…ï¼ˆSupabaseãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã¨åŒã˜å½¢å¼ï¼‰
- [x] ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°å®Ÿè£…ï¼ˆå¾Œã§Supabaseç½®ãæ›ãˆå¯èƒ½ï¼‰
- [x] å‹•çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å®Ÿè£…ï¼ˆprojects.htmlï¼‰
- [x] URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é€£æºå®Ÿè£…ï¼ˆprojects.html â†” storyboard.htmlï¼‰
- [x] ç”»é¢é·ç§»ãƒ•ãƒ­ãƒ¼ç¢ºç«‹ï¼ˆlogin â†’ index â†’ projects â†’ storyboardï¼‰

**æˆæœç‰©:**
- ãƒ‡ãƒ¼ã‚¿ã¨UIãŒå®Œå…¨ã«åˆ†é›¢ã•ã‚ŒãŸå®Ÿè£…
- Supabaseæ¥ç¶šæ™‚ã¯é–¢æ•°1ã¤ã®å¤‰æ›´ã®ã¿ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
- å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã§å†ç¾

### Phase 1: èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰

- [ ] allowed_emails ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- [ ] login.html ã«èªè¨¼æ©Ÿèƒ½å®Ÿè£…ï¼ˆç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã¿ï¼‰
- [ ] index.html ã«èªè¨¼ãƒã‚§ãƒƒã‚¯è¿½åŠ 
- [ ] projects.html ã«èªè¨¼ãƒã‚§ãƒƒã‚¯è¿½åŠ 
- [ ] storyboard.html ã«èªè¨¼ãƒã‚§ãƒƒã‚¯è¿½åŠ 
- [ ] å…¨HTMLã«èªè¨¼ãƒã‚§ãƒƒã‚¯è¿½åŠ 

### Phase 2: Supabase ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰

- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆï¼ˆprojects, scenes, dialoguesãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- [ ] RLSè¨­å®š
- [ ] Storageè¨­å®šï¼ˆç”»åƒãƒ»å‹•ç”»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”¨ï¼‰
- [ ] projects.html ã® loadProjects() ã‚’Supabaseç‰ˆã«ç½®ãæ›ãˆ
- [ ] storyboard.html ã® loadProject() ã‚’Supabaseç‰ˆã«ç½®ãæ›ãˆ
- [ ] CRUDå‡¦ç†å®Ÿè£…ï¼ˆã‚·ãƒ¼ãƒ³ãƒ»ã‚»ãƒªãƒ•ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ï¼‰
- [ ] ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Ÿè£…ï¼ˆSupabase Storageé€£æºï¼‰

### Phase 3: åŸç¨¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰

- [ ] YAMLãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®šç¾©
- [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«UIä½œæˆ
- [ ] YAMLç›´æ¥ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè£…
- [ ] AIè§£ææ©Ÿèƒ½å®Ÿè£…ï¼ˆGemini API - **gemini-3-pro-preview**ï¼‰
- [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†å®Ÿè£…ï¼ˆSupabaseé€£æºï¼‰

### Phase 4: ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰

- [ ] Renderãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- [ ] ç’°å¢ƒå¤‰æ•°è¨­å®š
- [ ] ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
- [ ] å‹•ä½œç¢ºèª

---

## å‚è€ƒè³‡æ–™

### å†…éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Supabase Database Design](./SUPABASE_DATABASE_DESIGN.md)
- [Veo3 API Reference](./VEO3_API_REFERENCE.md)
- [API Integration Best Practices](./API_INTEGRATION_BEST_PRACTICES.md)

### å¤–éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆå…¬å¼ï¼‰

#### Google API
- **[Gemini API Modelsï¼ˆæœ€æ–°ãƒ¢ãƒ‡ãƒ«æƒ…å ±ï¼‰](https://ai.google.dev/gemini-api/docs/models?hl=ja)** â­ æœ€æ–°æƒ…å ±ã¯ã“ã“ã‚’ç¢ºèª
  - Gemini 3 Pro Previewï¼ˆåŸç¨¿è§£æï¼‰
  - Gemini 3 Pro Image Preview / Nano Banana Proï¼ˆç”»åƒç”Ÿæˆï¼‰
  - Veo 3.1ï¼ˆå‹•ç”»ç”Ÿæˆï¼‰
- **[Gemini Image Generationï¼ˆç”»åƒç”Ÿæˆã‚¬ã‚¤ãƒ‰ï¼‰](https://ai.google.dev/gemini-api/docs/image-generation?hl=ja)**
- [Google AI Studio](https://aistudio.google.com/) - APIã‚­ãƒ¼å–å¾—

#### Supabase
- [Supabase Documentation](https://supabase.com/docs)
- [Supabase Auth - Google OAuth](https://supabase.com/docs/guides/auth/social-login/auth-google)
- [Row Level Security](https://supabase.com/docs/guides/auth/row-level-security)

#### ãã®ä»–
- [js-yaml](https://github.com/nodeca/js-yaml) - YAML ãƒ‘ãƒ¼ã‚µãƒ¼
