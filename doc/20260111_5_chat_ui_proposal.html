<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç”»åƒç”ŸæˆUIææ¡ˆ - ãƒˆãƒ¼ã‚¯å½¢å¼</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f5f5f5;
      padding: 40px;
      line-height: 1.6;
    }

    .header {
      background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
      color: white;
      padding: 50px;
      text-align: center;
      border-radius: 20px;
      margin-bottom: 40px;
      box-shadow: 0 8px 30px rgba(124, 58, 237, 0.3);
    }

    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 15px;
    }

    .header .subtitle {
      font-size: 1.2rem;
      opacity: 0.95;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
    }

    .section {
      background: white;
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .section-title {
      font-size: 2rem;
      color: #1f2937;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 3px solid #7c3aed;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .info-box {
      background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
      border: 3px solid #3b82f6;
      border-radius: 12px;
      padding: 25px;
      margin: 20px 0;
    }

    .info-box-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: #1e3a8a;
      margin-bottom: 12px;
    }

    .info-box-content {
      color: #1e40af;
      line-height: 1.8;
      font-size: 1.05rem;
    }

    /* ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—UI */
    .mockup-container {
      background: #f9fafb;
      border: 3px solid #e5e7eb;
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
    }

    .mockup-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #374151;
      margin-bottom: 20px;
      text-align: center;
    }

    /* ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
    .chat-history {
      background: white;
      border-radius: 12px;
      padding: 25px;
      max-height: 600px;
      overflow-y: auto;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
    }

    .message {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .message.user-message {
      flex-direction: row;
    }

    .message.ai-message {
      flex-direction: row-reverse;
    }

    .avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .message.user-message .avatar {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    }

    .message.ai-message .avatar {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    .message-content {
      flex: 1;
      max-width: 70%;
    }

    .message.user-message .message-content {
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
      border: 2px solid #3b82f6;
      border-radius: 16px 16px 16px 4px;
    }

    .message.ai-message .message-content {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border: 2px solid #10b981;
      border-radius: 16px 16px 4px 16px;
    }

    .message-bubble {
      padding: 18px 22px;
    }

    .prompt-text {
      font-size: 1.05rem;
      color: #1f2937;
      margin-bottom: 12px;
      font-weight: 500;
    }

    .reference-images {
      display: flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .reference-thumb {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      object-fit: cover;
      border: 2px solid rgba(0,0,0,0.1);
      transition: transform 0.2s;
      cursor: pointer;
      background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: #6b7280;
    }

    .reference-thumb:hover {
      transform: scale(1.1);
      border-color: #7c3aed;
    }

    .generated-image {
      width: 100%;
      max-width: 400px;
      border-radius: 12px;
      margin-top: 12px;
      cursor: pointer;
      transition: transform 0.2s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
      min-height: 250px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #6b7280;
      font-size: 0.95rem;
    }

    .generated-image:hover {
      transform: scale(1.02);
    }

    .timestamp {
      font-size: 0.85rem;
      color: #6b7280;
      margin-top: 8px;
    }

    .message-actions {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }

    .action-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: 2px solid;
      background: white;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s;
    }

    .action-btn.select {
      border-color: #10b981;
      color: #10b981;
    }

    .action-btn.select:hover {
      background: #10b981;
      color: white;
    }

    .action-btn.regenerate {
      border-color: #f59e0b;
      color: #f59e0b;
    }

    .action-btn.regenerate:hover {
      background: #f59e0b;
      color: white;
    }

    .load-more {
      text-align: center;
      margin: 20px 0;
    }

    .load-more-btn {
      padding: 12px 30px;
      border-radius: 12px;
      border: 3px solid #7c3aed;
      background: white;
      color: #7c3aed;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
    }

    .load-more-btn:hover {
      background: #7c3aed;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
    }

    /* æ¯”è¼ƒãƒ†ãƒ¼ãƒ–ãƒ« */
    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin: 30px 0;
    }

    .comparison-item {
      border: 3px solid #e5e7eb;
      border-radius: 12px;
      padding: 25px;
    }

    .comparison-item.good {
      border-color: #10b981;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    }

    .comparison-item.bad {
      border-color: #ef4444;
      background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
    }

    .comparison-label {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .comparison-item.good .comparison-label {
      color: #065f46;
    }

    .comparison-item.bad .comparison-label {
      color: #991b1b;
    }

    .comparison-content {
      line-height: 1.8;
      font-size: 1.05rem;
    }

    .comparison-item.good .comparison-content {
      color: #047857;
    }

    .comparison-item.bad .comparison-content {
      color: #b91c1c;
    }

    /* æŠ€è¡“ä»•æ§˜ */
    .spec-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }

    .spec-card {
      background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
    }

    .spec-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 10px;
    }

    .spec-content {
      color: #6b7280;
      line-height: 1.7;
      font-size: 0.95rem;
    }

    .spec-content code {
      background: #e5e7eb;
      padding: 2px 8px;
      border-radius: 4px;
      font-family: 'Monaco', monospace;
      color: #1f2937;
      font-size: 0.9rem;
    }

    /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
    .code-block {
      background: #1f2937;
      color: #e5e7eb;
      padding: 25px;
      border-radius: 12px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 0.9rem;
      line-height: 1.8;
      overflow-x: auto;
      margin: 20px 0;
    }

    .code-comment {
      color: #9ca3af;
    }

    .code-keyword {
      color: #fbbf24;
    }

    .code-string {
      color: #10b981;
    }

    .code-function {
      color: #60a5fa;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ¨ ç”»åƒç”ŸæˆUIææ¡ˆ - ãƒˆãƒ¼ã‚¯å½¢å¼</h1>
    <p class="subtitle">ChatGPTé¢¨ã®ãƒˆãƒ¼ã‚¯å½¢å¼ã§ç”»åƒç”Ÿæˆå±¥æ­´ã‚’è¡¨ç¤º</p>
  </div>

  <div class="container">
    <!-- æ¦‚è¦ -->
    <div class="section">
      <h2 class="section-title">ğŸ“‹ ææ¡ˆæ¦‚è¦</h2>

      <div class="info-box">
        <div class="info-box-title">ğŸ’¡ ã‚³ãƒ³ã‚»ãƒ—ãƒˆ</div>
        <div class="info-box-content">
          <strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨AIã®å¯¾è©±ã¨ã—ã¦ç”»åƒç”Ÿæˆå±¥æ­´ã‚’è¡¨ç¤º</strong><br>
          ãƒ»ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¥åŠ› â†’ AIå¿œç­”ï¼ˆç”»åƒç”Ÿæˆï¼‰ã®æµã‚Œã‚’è¦–è¦šåŒ–<br>
          ãƒ»å‚ç…§ç”»åƒã‚‚ä¸€ç·’ã«è¡¨ç¤ºã—ã¦ã€Œã©ã†ã‚„ã£ã¦ä½œã£ãŸã‹ã€ãŒä¸€ç›®ã§ã‚ã‹ã‚‹<br>
          ãƒ»ChatGPTçš„ãªUIã§ç›´æ„Ÿçš„ã«æ“ä½œå¯èƒ½
        </div>
      </div>

      <div class="comparison">
        <div class="comparison-item good">
          <div class="comparison-label">âœ… ãƒˆãƒ¼ã‚¯å½¢å¼ã®ãƒ¡ãƒªãƒƒãƒˆ</div>
          <div class="comparison-content">
            <strong>ç›´æ„Ÿçš„:</strong> ä¼šè©±ã®æµã‚Œã§ç†è§£ã—ã‚„ã™ã„<br>
            <strong>æ™‚ç³»åˆ—:</strong> è©¦è¡ŒéŒ¯èª¤ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒå¯è¦–åŒ–<br>
            <strong>å†ç¾æ€§:</strong> éå»ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ»å‚ç…§ç”»åƒã‚’ç¢ºèªå¯èƒ½<br>
            <strong>è¦ªã—ã¿ã‚„ã™ã•:</strong> ChatGPTçš„ãªUIã§é¦´æŸ“ã¿ã‚„ã™ã„
          </div>
        </div>

        <div class="comparison-item bad">
          <div class="comparison-label">âš ï¸ æ‡¸å¿µç‚¹ï¼ˆè§£æ±ºç­–ã‚ã‚Šï¼‰</div>
          <div class="comparison-content">
            <strong>é‡ããªã‚‹?</strong> â†’ æœ€æ–°10ä»¶ã®ã¿è¡¨ç¤ºï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼‰<br>
            <strong>ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒé•·ã„?</strong> â†’ é…å»¶èª­ã¿è¾¼ã¿ï¼ˆlazy loadingï¼‰<br>
            <strong>ç”»åƒãŒå¤šã„?</strong> â†’ ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤º â†’ ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ãƒ«ã‚µã‚¤ã‚º<br>
            <strong>æ›´æ–°é »ç¹?</strong> â†’ Realtimeè³¼èª­ã§å·®åˆ†æ›´æ–°ã®ã¿
          </div>
        </div>
      </div>
    </div>

    <!-- ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ— -->
    <div class="section">
      <h2 class="section-title">ğŸ¨ UIãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—</h2>
      <p style="color: #6b7280; margin-bottom: 20px;">ã‚·ãƒ¼ãƒ³ #1 ã®ç”»åƒç”Ÿæˆå±¥æ­´ï¼ˆãƒˆãƒ¼ã‚¯å½¢å¼ï¼‰</p>

      <div class="mockup-container">
        <div class="mockup-title">ç”»åƒç”Ÿæˆå±¥æ­´</div>

        <div class="chat-history">
          <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸1 -->
          <div class="message user-message">
            <div class="avatar">ğŸ‘¤</div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="prompt-text">ã€Œç¾ã—ã„é¢¨æ™¯ã‚’ç”Ÿæˆã—ã¦ã€</div>
                <div class="reference-images">
                  <div class="reference-thumb">å‚ç…§ç”»åƒ1<br>ğŸ“·</div>
                  <div class="reference-thumb">å‚ç…§ç”»åƒ2<br>ğŸ“·</div>
                </div>
                <div class="timestamp">2026-01-11 10:30</div>
              </div>
            </div>
          </div>

          <div class="message ai-message">
            <div class="avatar">ğŸ¤–</div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="generated-image">ç”Ÿæˆã•ã‚ŒãŸç”»åƒ<br>ğŸ–¼ï¸<br>(400x300px)</div>
                <div class="message-actions">
                  <button class="action-btn select">âœ“ æ¡ç”¨</button>
                  <button class="action-btn regenerate">ğŸ”„ å†ç”Ÿæˆ</button>
                </div>
                <div class="timestamp">2026-01-11 10:31</div>
              </div>
            </div>
          </div>

          <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸2 -->
          <div class="message user-message">
            <div class="avatar">ğŸ‘¤</div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="prompt-text">ã€Œã‚‚ã£ã¨ã‚¢ãƒ‹ãƒ¡é¢¨ã«å¤‰æ›´ã—ã¦ã€</div>
                <div class="reference-images">
                  <div class="reference-thumb">å‚ç…§ç”»åƒ1<br>ğŸ“·</div>
                  <div class="reference-thumb">å‚ç…§ç”»åƒ2<br>ğŸ“·</div>
                  <div class="reference-thumb">å‚ç…§ç”»åƒ3<br>ğŸ“·</div>
                </div>
                <div class="timestamp">2026-01-11 10:35</div>
              </div>
            </div>
          </div>

          <div class="message ai-message">
            <div class="avatar">ğŸ¤–</div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="generated-image">ã‚¢ãƒ‹ãƒ¡é¢¨ã®ç”»åƒ<br>ğŸ–¼ï¸<br>(400x300px)</div>
                <div class="message-actions">
                  <button class="action-btn select">âœ“ æ¡ç”¨</button>
                  <button class="action-btn regenerate">ğŸ”„ å†ç”Ÿæˆ</button>
                </div>
                <div class="timestamp">2026-01-11 10:36</div>
              </div>
            </div>
          </div>

          <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸3 -->
          <div class="message user-message">
            <div class="avatar">ğŸ‘¤</div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="prompt-text">ã€Œè‰²ã‚’ã‚‚ã£ã¨é®®ã‚„ã‹ã«ã—ã¦ã€</div>
                <div class="timestamp">2026-01-11 10:40</div>
              </div>
            </div>
          </div>

          <div class="message ai-message">
            <div class="avatar">ğŸ¤–</div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="generated-image">é®®ã‚„ã‹ãªç”»åƒ<br>ğŸ–¼ï¸<br>(400x300px)<br><strong style="color: #10b981;">âœ“ æ¡ç”¨æ¸ˆã¿</strong></div>
                <div class="message-actions">
                  <button class="action-btn regenerate">ğŸ”„ å†ç”Ÿæˆ</button>
                </div>
                <div class="timestamp">2026-01-11 10:41</div>
              </div>
            </div>
          </div>
        </div>

        <div class="load-more">
          <button class="load-more-btn">ã‚‚ã£ã¨è¦‹ã‚‹ï¼ˆ7ä»¶ã®å±¥æ­´ï¼‰</button>
        </div>
      </div>
    </div>

    <!-- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ -->
    <div class="section">
      <h2 class="section-title">ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆä¿®æ­£ç‰ˆï¼‰</h2>

      <div class="info-box">
        <div class="info-box-title">ğŸ”§ imagesãƒ†ãƒ¼ãƒ–ãƒ«ã« reference_images ã‚«ãƒ©ãƒ ã‚’è¿½åŠ </div>
        <div class="info-box-content">
          å‚ç…§ç”»åƒã®URLé…åˆ—ã‚’JSONBå½¢å¼ã§ä¿å­˜ã™ã‚‹ã“ã¨ã§ã€ã€Œã©ã®å‚ç…§ç”»åƒã‚’ä½¿ã£ãŸã‹ã€ã‚’è¨˜éŒ²ã§ãã¾ã™ã€‚
        </div>
      </div>

      <div class="code-block">
<span class="code-keyword">CREATE TABLE</span> images (
  id <span class="code-string">UUID</span> <span class="code-keyword">PRIMARY KEY DEFAULT</span> gen_random_uuid(),
  scene_id <span class="code-string">UUID</span> <span class="code-keyword">REFERENCES</span> scenes(id) <span class="code-keyword">ON DELETE CASCADE</span>,

  <span class="code-comment">-- ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</span>
  prompt <span class="code-string">TEXT</span> <span class="code-keyword">NOT NULL</span>,

  <span class="code-comment">-- ç”Ÿæˆã•ã‚ŒãŸç”»åƒ</span>
  image_url <span class="code-string">TEXT</span>,

  <span class="code-comment">-- å‚ç…§ç”»åƒï¼ˆè¤‡æ•°ã®å ´åˆã¯JSONé…åˆ—ï¼‰ğŸ‘ˆ NEW!</span>
  reference_images <span class="code-string">JSONB</span>,

  <span class="code-comment">-- æ¡ç”¨ãƒ•ãƒ©ã‚°</span>
  selected <span class="code-string">BOOLEAN</span> <span class="code-keyword">DEFAULT</span> <span class="code-keyword">false</span>,

  created_at <span class="code-string">TIMESTAMPTZ</span> <span class="code-keyword">DEFAULT</span> NOW(),

  <span class="code-keyword">CONSTRAINT</span> one_selected_per_scene <span class="code-keyword">UNIQUE</span> (scene_id, selected)
    <span class="code-keyword">WHERE</span> (selected = <span class="code-keyword">true</span>)
);

<span class="code-comment">-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ</span>
<span class="code-keyword">CREATE INDEX</span> idx_images_reference_images
  <span class="code-keyword">ON</span> images <span class="code-keyword">USING GIN</span> (reference_images);
      </div>

      <p style="margin: 20px 0; color: #6b7280; font-size: 1.05rem;"><strong>ãƒ‡ãƒ¼ã‚¿ä¾‹:</strong></p>

      <div class="code-block">
{
  <span class="code-string">"id"</span>: <span class="code-string">"img-123"</span>,
  <span class="code-string">"scene_id"</span>: <span class="code-string">"scene-456"</span>,
  <span class="code-string">"prompt"</span>: <span class="code-string">"ç¾ã—ã„é¢¨æ™¯ã‚’ã‚¢ãƒ‹ãƒ¡é¢¨ã«"</span>,
  <span class="code-string">"image_url"</span>: <span class="code-string">"https://xxx.supabase.co/storage/.../generated-123.png"</span>,
  <span class="code-string">"reference_images"</span>: [
    {
      <span class="code-string">"url"</span>: <span class="code-string">"https://xxx.supabase.co/storage/.../ref-001.png"</span>,
      <span class="code-string">"uploaded_at"</span>: <span class="code-string">"2026-01-11T10:30:00Z"</span>
    },
    {
      <span class="code-string">"url"</span>: <span class="code-string">"https://xxx.supabase.co/storage/.../ref-002.png"</span>,
      <span class="code-string">"uploaded_at"</span>: <span class="code-string">"2026-01-11T10:31:00Z"</span>
    }
  ],
  <span class="code-string">"selected"</span>: <span class="code-keyword">false</span>,
  <span class="code-string">"created_at"</span>: <span class="code-string">"2026-01-11T10:32:00Z"</span>
}
      </div>
    </div>

    <!-- å®Ÿè£…ä»•æ§˜ -->
    <div class="section">
      <h2 class="section-title">âš™ï¸ å®Ÿè£…ä»•æ§˜</h2>

      <div class="spec-grid">
        <div class="spec-card">
          <div class="spec-title">ğŸ“Š ãƒ‡ãƒ¼ã‚¿å–å¾—</div>
          <div class="spec-content">
            æœ€æ–°10ä»¶ã®ã¿å–å¾—ã—ã¦è¡¨ç¤º<br>
            <code>LIMIT 10</code> + <code>ORDER BY created_at DESC</code><br>
            ã€Œã‚‚ã£ã¨è¦‹ã‚‹ã€ã§ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
          </div>
        </div>

        <div class="spec-card">
          <div class="spec-title">ğŸ–¼ï¸ ç”»åƒè¡¨ç¤º</div>
          <div class="spec-content">
            é…å»¶èª­ã¿è¾¼ã¿: <code>loading="lazy"</code><br>
            ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºï¼ˆmax-width: 400pxï¼‰<br>
            ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ãƒ«ã‚µã‚¤ã‚ºãƒ¢ãƒ¼ãƒ€ãƒ«
          </div>
        </div>

        <div class="spec-card">
          <div class="spec-title">ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°</div>
          <div class="spec-content">
            Supabase Realtimeè³¼èª­<br>
            æ–°è¦ç”»åƒã®INSERTã‚¤ãƒ™ãƒ³ãƒˆã ã‘ç›£è¦–<br>
            å·®åˆ†æ›´æ–°ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¶­æŒ
          </div>
        </div>

        <div class="spec-card">
          <div class="spec-title">ğŸ’¾ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡</div>
          <div class="spec-content">
            å‚ç…§ç”»åƒ: ç´„1MB/æš<br>
            ç”Ÿæˆç”»åƒ: ç´„2MB/æš<br>
            10ã‚·ãƒ¼ãƒ³ Ã— 3å› = ç´„90MB/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
          </div>
        </div>

        <div class="spec-card">
          <div class="spec-title">âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</div>
          <div class="spec-content">
            åˆæœŸèª­ã¿è¾¼ã¿: 10ä»¶ã®ã¿ï¼ˆç´„20MBï¼‰<br>
            è¿½åŠ èª­ã¿è¾¼ã¿: 10ä»¶ãšã¤<br>
            ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨
          </div>
        </div>

        <div class="spec-card">
          <div class="spec-title">ğŸ¯ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“</div>
          <div class="spec-content">
            ChatGPTé¢¨ã®UIã§ç›´æ„Ÿçš„<br>
            è©¦è¡ŒéŒ¯èª¤ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒå¯è¦–åŒ–<br>
            æ¡ç”¨/å†ç”Ÿæˆã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒæ˜ç¢º
          </div>
        </div>
      </div>
    </div>

    <!-- å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹ -->
    <div class="section">
      <h2 class="section-title">ğŸ’» å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹</h2>

      <h3 style="font-size: 1.3rem; color: #1f2937; margin: 25px 0 15px;">ãƒ‡ãƒ¼ã‚¿å–å¾—</h3>

      <div class="code-block">
<span class="code-comment">// æœ€æ–°10ä»¶ã®ç”»åƒç”Ÿæˆå±¥æ­´ã‚’å–å¾—</span>
<span class="code-keyword">const</span> { data: images } = <span class="code-keyword">await</span> <span class="code-function">supabaseClient</span>
  .<span class="code-function">from</span>(<span class="code-string">'images'</span>)
  .<span class="code-function">select</span>(<span class="code-string">'*'</span>)
  .<span class="code-function">eq</span>(<span class="code-string">'scene_id'</span>, currentSceneId)
  .<span class="code-function">order</span>(<span class="code-string">'created_at'</span>, { ascending: <span class="code-keyword">false</span> })
  .<span class="code-function">limit</span>(<span class="code-keyword">10</span>);

<span class="code-comment">// ãƒˆãƒ¼ã‚¯å½¢å¼ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°</span>
images.<span class="code-function">forEach</span>(image => {
  <span class="code-function">renderUserMessage</span>(image.prompt, image.reference_images, image.created_at);
  <span class="code-function">renderAiMessage</span>(image.image_url, image.selected, image.id);
});
      </div>

      <h3 style="font-size: 1.3rem; color: #1f2937; margin: 35px 0 15px;">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°</h3>

      <div class="code-block">
<span class="code-comment">// æ–°è¦ç”»åƒã®INSERTã‚’ç›£è¦–</span>
<span class="code-keyword">const</span> subscription = <span class="code-function">supabaseClient</span>
  .<span class="code-function">channel</span>(<span class="code-string">'images'</span>)
  .<span class="code-function">on</span>(<span class="code-string">'postgres_changes'</span>, {
    event: <span class="code-string">'INSERT'</span>,
    schema: <span class="code-string">'public'</span>,
    table: <span class="code-string">'images'</span>,
    filter: <span class="code-string">`scene_id=eq.${currentSceneId}`</span>
  }, (payload) => {
    <span class="code-comment">// æ–°ã—ã„ç”»åƒã ã‘è¿½åŠ ï¼ˆå…¨ä½“ã‚’å†èª­ã¿è¾¼ã¿ã—ãªã„ï¼‰</span>
    <span class="code-keyword">const</span> newImage = payload.new;
    <span class="code-function">renderUserMessage</span>(newImage.prompt, newImage.reference_images, newImage.created_at);
    <span class="code-function">renderAiMessage</span>(newImage.image_url, newImage.selected, newImage.id);
  })
  .<span class="code-function">subscribe</span>();
      </div>

      <h3 style="font-size: 1.3rem; color: #1f2937; margin: 35px 0 15px;">å‚ç…§ç”»åƒã®ä¿å­˜</h3>

      <div class="code-block">
<span class="code-comment">// 1. å‚ç…§ç”»åƒã‚’Storageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
<span class="code-keyword">const</span> referenceUrls = [];

<span class="code-keyword">for</span> (<span class="code-keyword">const</span> file <span class="code-keyword">of</span> referenceFiles) {
  <span class="code-keyword">const</span> { data } = <span class="code-keyword">await</span> <span class="code-function">supabaseClient</span>.storage
    .<span class="code-function">from</span>(<span class="code-string">'storyboard-images'</span>)
    .<span class="code-function">upload</span>(<span class="code-string">`${userId}/references/${<span class="code-function">uuid</span>()}.png`</span>, file);

  referenceUrls.<span class="code-function">push</span>({
    url: data.publicUrl,
    uploaded_at: <span class="code-keyword">new</span> <span class="code-function">Date</span>().<span class="code-function">toISOString</span>()
  });
}

<span class="code-comment">// 2. ç”»åƒç”Ÿæˆ</span>
<span class="code-keyword">const</span> response = <span class="code-keyword">await</span> <span class="code-function">fetch</span>(<span class="code-string">'/functions/v1/generate-image'</span>, {
  method: <span class="code-string">'POST'</span>,
  body: <span class="code-function">JSON.stringify</span>({
    prompt: userPrompt,
    referenceImages: referenceUrls.<span class="code-function">map</span>(r => r.url)
  })
});

<span class="code-keyword">const</span> { imageBase64 } = <span class="code-keyword">await</span> response.<span class="code-function">json</span>();

<span class="code-comment">// 3. ç”Ÿæˆç”»åƒã‚’Storageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
<span class="code-keyword">const</span> blob = <span class="code-function">base64ToBlob</span>(imageBase64);
<span class="code-keyword">const</span> { data: uploadData } = <span class="code-keyword">await</span> <span class="code-function">supabaseClient</span>.storage
  .<span class="code-function">from</span>(<span class="code-string">'storyboard-images'</span>)
  .<span class="code-function">upload</span>(<span class="code-string">`${userId}/scenes/${sceneId}/${<span class="code-function">uuid</span>()}.png`</span>, blob);

<span class="code-comment">// 4. imagesãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜</span>
<span class="code-keyword">await</span> <span class="code-function">supabaseClient</span>
  .<span class="code-function">from</span>(<span class="code-string">'images'</span>)
  .<span class="code-function">insert</span>({
    scene_id: currentSceneId,
    prompt: userPrompt,
    image_url: uploadData.publicUrl,
    reference_images: referenceUrls  <span class="code-comment">// ğŸ‘ˆ å‚ç…§ç”»åƒã‚‚ä¿å­˜ï¼</span>
  });
      </div>
    </div>

    <!-- ã¾ã¨ã‚ -->
    <div class="section">
      <h2 class="section-title">ğŸ“ ã¾ã¨ã‚</h2>

      <div class="info-box" style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); border-color: #10b981;">
        <div class="info-box-title" style="color: #065f46;">âœ… ã“ã®ææ¡ˆã®ãƒã‚¤ãƒ³ãƒˆ</div>
        <div class="info-box-content" style="color: #047857;">
          <strong>1. ãƒˆãƒ¼ã‚¯å½¢å¼UIã§ç›´æ„Ÿçš„</strong><br>
          ChatGPTé¢¨ã®å¯¾è©±å½¢å¼ã§ã€è©¦è¡ŒéŒ¯èª¤ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒå¯è¦–åŒ–ã•ã‚Œã¾ã™ã€‚<br><br>

          <strong>2. å‚ç…§ç”»åƒã‚‚ä¿å­˜ã—ã¦å†ç¾æ€§ã‚’ç¢ºä¿</strong><br>
          reference_imagesã‚«ãƒ©ãƒ ï¼ˆJSONBï¼‰ã§å‚ç…§ç”»åƒURLã‚’é…åˆ—ä¿å­˜ã€‚å¾Œã‹ã‚‰ç¢ºèªãƒ»å†åˆ©ç”¨ãŒå¯èƒ½ã€‚<br><br>

          <strong>3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–</strong><br>
          æœ€æ–°10ä»¶ã®ã¿è¡¨ç¤ºã€é…å»¶èª­ã¿è¾¼ã¿ã€Realtimeå·®åˆ†æ›´æ–°ã§è»½é‡åŒ–ã€‚<br><br>

          <strong>4. ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚³ã‚¹ãƒˆã¯è¨±å®¹ç¯„å›²</strong><br>
          1ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç´„90MBã€‚Supabaseã®ç„¡æ–™æ ï¼ˆ1GBï¼‰ã§ç´„11ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆå¯èƒ½ã€‚<br><br>

          <strong>5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å‘ä¸Š</strong><br>
          æ¡ç”¨/å†ç”Ÿæˆã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒæ˜ç¢ºã€‚ç”»åƒç”Ÿæˆã®å±¥æ­´ãŒä¸€ç›®ã§ã‚ã‹ã‚‹ã€‚
        </div>
      </div>

      <div style="text-align: center; margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%); border-radius: 12px;">
        <h3 style="font-size: 1.5rem; color: #1f2937; margin-bottom: 15px;">ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
        <p style="color: #6b7280; font-size: 1.1rem; line-height: 1.8;">
          1. imagesãƒ†ãƒ¼ãƒ–ãƒ«ã« <code>reference_images JSONB</code> ã‚«ãƒ©ãƒ ã‚’è¿½åŠ <br>
          2. ãƒˆãƒ¼ã‚¯å½¢å¼UIã®åŸºæœ¬å®Ÿè£…ï¼ˆæœ€æ–°10ä»¶è¡¨ç¤ºï¼‰<br>
          3. å‚ç…§ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã®å®Ÿè£…<br>
          4. ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã€Œã‚‚ã£ã¨è¦‹ã‚‹ã€ãƒœã‚¿ãƒ³ï¼‰<br>
          5. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®å®Ÿè£…
        </p>
      </div>
    </div>
  </div>
</body>
</html>